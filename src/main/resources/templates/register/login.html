<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>코딩의 집 | 로그인</title>
    <link rel="stylesheet" th:href="@{/css/app.css}">
    <link rel="stylesheet" th:href="@{/css/auth.css}">
</head>
<body class="register-page">
<main class="register-shell login-shell">
    <div class="register-brand" aria-label="서비스 로고">
        <img class="logo" th:src="@{/images/logo.png}" alt="코딩의 집 로고" />
        <div class="name">코딩의 집</div>
    </div>

    <section class="register-shell__form" aria-label="로그인 폼">
        <div class="register-card">
            <header class="register-card__header">
                <h2>로그인</h2>
                <p>가입한 이메일과 비밀번호를 입력해 주세요.</p>
            </header>

            <form id="loginForm" th:action="@{/controller/register/login-form}" method="post">
                <div class="form-grid">
                    <div class="form-field">
                        <label for="email">이메일</label>
                        <input id="email" name="loginEmail" type="email" class="input" placeholder="아이디(이메일)" autocomplete="username" required />
                        <span class="field-error" aria-live="polite"
                              th:if="${param.error != null and param.error[0] == 'email'}">등록되지 않은 이메일입니다.</span>
                    </div>

                    <div class="form-field">
                        <label for="password">비밀번호</label>
                        <input id="password" name="password" type="password" class="input" placeholder="비밀번호" autocomplete="current-password" minlength="4" required />
                        <span class="field-error" aria-live="polite"
                              th:if="${param.error != null and param.error[0] != 'email'}"
                              th:text="${param.error[0] == 'password'} ? '비밀번호가 올바르지 않습니다. 다시 확인해 주세요.' : '로그인에 실패했습니다. 다시 시도해 주세요.'"></span>
                    </div>
                </div>

                <div class="register-alert --success" aria-live="polite" th:if="${param.reset}">비밀번호가 변경되었습니다. 새 비밀번호로 로그인해 주세요.</div>

                <button type="submit" class="register-submit">로그인</button>
                <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                <div class="login-support">
                    <nav class="help" aria-label="보조 링크">
                        <a th:href="@{/account/reset}">비밀번호 재설정</a>
                        <a th:href="@{/account/register}">회원가입</a>
                    </nav>

                    <div class="sns-wrap">
                        <div class="sns-row" role="group" aria-label="SNS 로그인">
                            <a class="sns kakao" th:href="@{/oauth2/authorization/kakao}" aria-label="카카오 로그인">
                                <svg width="26" height="26" viewBox="0 0 24 24" fill="#3c1e1e" aria-hidden="true"><path d="M12 4.5c-4.42 0-8 2.64-8 5.9 0 1.93 1.24 3.64 3.15 4.75l-1 3.35a.6.6 0 0 0 .9.68l3.5-2.2c.46.05.93.08 1.45.08 4.42 0 8-2.64 8-5.9S16.42 4.5 12 4.5z"/></svg>
                            </a>
                            <a class="sns naver" th:href="@{/oauth2/authorization/naver}" aria-label="네이버 로그인">
                                <svg width="26" height="26" viewBox="0 0 24 24" fill="#fff" aria-hidden="true"><path d="M7 5h4.2l5.8 8.1V5H19v14h-4.2L9 10.9V19H7z"/></svg>
                            </a>
                        </div>
                        <div class="sns-label">SNS계정으로 간편 로그인/회원가입</div>
                    </div>
                </div>
            </form>
        </div>
    </section>
</main>

<script>
    // 필드 포커스 시 간단한 에러 스타일 처리
    const email = document.getElementById('email');
    const pw = document.getElementById('password');
    const setError = (el, on) => el.classList.toggle('error', !!on);
    [email, pw].forEach(i => i.addEventListener('invalid', () => setError(i, true)));
    [email, pw].forEach(i => i.addEventListener('input', () => setError(i, false)));
</script>
</body>
</html>
