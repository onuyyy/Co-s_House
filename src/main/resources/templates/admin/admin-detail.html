<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
      layout:decorate="~{layout/admin-layout}"
      lang="ko">
<head>
    <title>ê´€ë¦¬ì ìƒì„¸ì •ë³´</title>
</head>
<body>
    <!-- Content Header -->
    <div layout:fragment="content-header" class="content-header">
        <div>
            <div class="breadcrumb">
                <a href="/api/admin/admins">ê´€ë¦¬ì ê´€ë¦¬</a> > ê´€ë¦¬ì ìƒì„¸ì •ë³´
            </div>
            <h2 style="color: #333; font-size: 24px; margin-top: 10px;">ğŸ‘¨â€ğŸ’¼ ê´€ë¦¬ì ìƒì„¸ì •ë³´</h2>
        </div>
        <div>
            <a href="/api/admin/admins" class="btn btn-secondary">ëª©ë¡ìœ¼ë¡œ</a>
        </div>
    </div>

    <!-- Main Content -->
    <div layout:fragment="content">
        <!-- ì•Œë¦¼ ë©”ì‹œì§€ -->
        <div th:if="${param.success == 'true'}" class="alert alert-success">
            ê´€ë¦¬ì ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
        </div>
        <div th:if="${param.success == 'role_changed'}" class="alert alert-success">
            ê´€ë¦¬ì ê¶Œí•œì´ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.
        </div>
        <div th:if="${param.error}" class="alert alert-danger">
            <span th:text="${param.error}">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</span>
        </div>

        <!-- ê´€ë¦¬ì ìƒíƒœ ë°°ë„ˆ -->
        <div class="admin-status-banner">
            <div class="status-icon">
                <span th:if="${admin.userRoleName == 'SUPER_ADMIN'}">ğŸ‘‘</span>
                <span th:unless="${admin.userRoleName == 'SUPER_ADMIN'}">ğŸ‘¨â€ğŸ’¼</span>
            </div>
            <div class="status-content">
                <h3 th:text="${admin.userName}">ê´€ë¦¬ìëª…</h3>
                <span th:class="${admin.userRoleName == 'SUPER_ADMIN' ? 'role-badge super-admin-role' : 'role-badge admin-role'}"
                      th:text="${admin.userRoleName == 'SUPER_ADMIN' ? 'ìµœê³  ê´€ë¦¬ì' : 'ê´€ë¦¬ì'}">ê´€ë¦¬ì</span>
            </div>
            <div class="status-actions">
                <button id="editModeBtn" class="btn btn-warning" onclick="toggleEditMode()">
                    âœï¸ ìˆ˜ì •í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- ê´€ë¦¬ì ì •ë³´ (ì½ê¸° ì „ìš©) -->
        <div class="detail-card" id="viewSection">
            <div class="detail-card-header">
                <h3>ğŸ” ê´€ë¦¬ì ê³„ì • ì •ë³´</h3>
            </div>
            <div class="detail-card-body">
                <div class="detail-grid">
                    <div class="detail-label">ê´€ë¦¬ì ID</div>
                    <div class="detail-value" th:text="${admin.userId}">1</div>
                    
                    <div class="detail-label">ì´ë¦„</div>
                    <div class="detail-value admin-name" th:text="${admin.userName}">ê´€ë¦¬ìëª…</div>
                    
                    <div class="detail-label">ë‹‰ë„¤ì„</div>
                    <div class="detail-value" th:text="${admin.userNickname}">ë‹‰ë„¤ì„</div>
                    
                    <div class="detail-label">ì´ë©”ì¼</div>
                    <div class="detail-value email-display" th:text="${admin.userEmail}">ì´ë©”ì¼</div>
                    
                    <div class="detail-label">ê´€ë¦¬ì ë“±ê¸‰</div>
                    <div class="detail-value">
                        <span th:class="${admin.userRoleName == 'SUPER_ADMIN' ? 'role-badge super-admin-role' : 'role-badge admin-role'}"
                              th:text="${admin.userRoleName == 'SUPER_ADMIN' ? 'ìµœê³  ê´€ë¦¬ì' : 'ê´€ë¦¬ì'}">ê´€ë¦¬ì</span>
                    </div>
                    
                    <div class="detail-label">ì—°ë½ì²˜</div>
                    <div class="detail-value" th:text="${admin.userPhone ?: 'ì •ë³´ ì—†ìŒ'}">ì—°ë½ì²˜</div>
                    
                    <div class="detail-label">ì£¼ì†Œ</div>
                    <div class="detail-value" th:text="${admin.userAddress ?: 'ì •ë³´ ì—†ìŒ'}">ì£¼ì†Œ</div>
                    
                    <div class="detail-label">ì†Œì…œ ë¡œê·¸ì¸</div>
                    <div class="detail-value" th:text="${admin.socialProvider ?: 'ì¼ë°˜ ê´€ë¦¬ì ê³„ì •'}">ì†Œì…œ ë¡œê·¸ì¸</div>

                    <div class="detail-label">ê³„ì • ìƒì„±ì¼</div>
                    <div class="detail-value" th:text="${admin.userCreatedAt != null ? #temporals.format(admin.userCreatedAt, 'yyyy-MM-dd HH:mm') : '-'}">ìƒì„±ì¼</div>
                    
                    <div class="detail-label">ìµœê·¼ ìˆ˜ì •ì¼</div>
                    <div class="detail-value" th:text="${admin.userUpdatedAt != null ? #temporals.format(admin.userUpdatedAt, 'yyyy-MM-dd HH:mm') : '-'}">ìˆ˜ì •ì¼</div>
                </div>
            </div>
        </div>

        <!-- ê´€ë¦¬ì ìˆ˜ì • í¼ -->
        <div class="detail-card" id="editSection" style="display: none;">
            <div class="detail-card-header">
                <h3>âœï¸ ê´€ë¦¬ì ì •ë³´ ìˆ˜ì •</h3>
            </div>
            <div class="detail-card-body">
                <form th:action="@{/api/admin/admins/{adminId}/update(adminId=${admin.userId})}" method="post" class="admin-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="userName" class="required">ì´ë¦„ *</label>
                            <input type="text" id="userName" name="userName" th:value="${admin.userName}" 
                                   class="form-control" required maxlength="50"
                                   placeholder="ê´€ë¦¬ì ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
                            <small class="form-text">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤. (ìµœëŒ€ 50ì)</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="userNickname" class="required">ë‹‰ë„¤ì„ *</label>
                            <input type="text" id="userNickname" name="userNickname" th:value="${admin.userNickname}" 
                                   class="form-control" required maxlength="20"
                                   placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”">
                            <small class="form-text">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤. (ìµœëŒ€ 20ì)</small>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="userEmail" class="required">ì´ë©”ì¼ *</label>
                            <input type="email" id="userEmail" name="userEmail" th:value="${admin.userEmail}" 
                                   class="form-control" required maxlength="255"
                                   placeholder="admin@example.com">
                            <small class="form-text">í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤. ê´€ë¦¬ì ë¡œê·¸ì¸ IDë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="userPhone">ì—°ë½ì²˜</label>
                            <input type="tel" id="userPhone" name="userPhone" th:value="${admin.userPhone}" 
                                   class="form-control" maxlength="20"
                                   placeholder="010-0000-0000">
                            <small class="form-text">ê´€ë¦¬ì ì—°ë½ì²˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</small>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="userAddress">ì£¼ì†Œ</label>
                            <textarea id="userAddress" name="userAddress" th:text="${admin.userAddress}" 
                                      class="form-control" rows="3" maxlength="200"
                                      placeholder="ê´€ë¦¬ì ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                            <small class="form-text">ê´€ë¦¬ìì˜ ì£¼ì†Œ ì •ë³´ì…ë‹ˆë‹¤. (ìµœëŒ€ 200ì)</small>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">ğŸ’¾ ìˆ˜ì • ì €ì¥</button>
                        <button type="button" class="btn btn-danger" onclick="deleteAdmin()">ğŸ—‘ï¸ ê´€ë¦¬ì ì‚­ì œ</button>
                        <button type="button" class="btn btn-secondary" onclick="toggleEditMode()">âŒ ì·¨ì†Œ</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <th:block layout:fragment="extra-css">
        <style>
            .admin-status-banner { display: flex; align-items: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; gap: 16px; }
            .status-icon { font-size: 48px; flex-shrink: 0; }
            .status-content { flex: 1; }
            .status-content h3 { margin: 0 0 8px 0; font-size: 24px; }
            .status-actions { display: flex; gap: 10px; }
            .detail-grid { display: grid; grid-template-columns: 150px 1fr; gap: 12px 20px; align-items: center; }
            .detail-label { font-weight: 600; color: #495057; background-color: #f8f9fa; padding: 8px 12px; border-radius: 6px; border: 1px solid #e9ecef; }
            .detail-value { background-color: #ffffff; padding: 8px 12px; border-radius: 6px; border: 1px solid #e9ecef; color: #212529; }
            .admin-name { font-size: 1.1em; font-weight: 600; color: #007bff; }
            .email-display { font-family: monospace; font-size: 0.9em; }
            .role-badge { padding: 6px 12px; border-radius: 12px; font-size: 12px; font-weight: bold; display: inline-flex; align-items: center; gap: 4px; }
            .admin-role { background-color: #fd7e14; color: white; }
            .super-admin-role { background: linear-gradient(45deg, #dc3545, #6f42c1); color: white; }
            .admin-form { max-width: 800px; }
            .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
            .form-row:has(.form-group:only-child) { grid-template-columns: 1fr; }
            .form-group { width: 100%; }
            .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; }
            .form-group label.required { color: #dc3545; }
            .form-control { width: 100%; padding: 10px 12px; border: 1px solid #ced4da; border-radius: 6px; font-size: 14px; }
            .form-control:focus { outline: 0; border-color: #80bdff; box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25); }
            .form-text { display: block; margin-top: 5px; color: #6c757d; font-size: 12px; }
            .form-actions { display: flex; gap: 10px; margin-top: 30px; padding-top: 20px; border-top: 1px solid #e9ecef; }
            .alert { padding: 12px 16px; margin-bottom: 20px; border: 1px solid transparent; border-radius: 4px; }
            .alert-success { color: #155724; background-color: #d4edda; border-color: #c3e6cb; }
            .alert-danger { color: #721c24; background-color: #f8d7da; border-color: #f5c6cb; }
        </style>
    </th:block>

    <th:block layout:fragment="extra-scripts">
        <script>
            function toggleEditMode() {
                const editBtn = document.getElementById('editModeBtn');
                const viewSection = document.getElementById('viewSection');
                const editSection = document.getElementById('editSection');
                
                const isEditing = editSection.style.display !== 'none';
                
                if (isEditing) {
                    viewSection.style.display = 'block';
                    editSection.style.display = 'none';
                    editBtn.innerHTML = 'âœï¸ ìˆ˜ì •í•˜ê¸°';
                    editBtn.className = 'btn btn-warning';
                } else {
                    viewSection.style.display = 'none';
                    editSection.style.display = 'block';
                    editBtn.innerHTML = 'ğŸ‘ï¸ ë³´ê¸° ëª¨ë“œ';
                    editBtn.className = 'btn btn-secondary';
                }
            }

            function deleteAdmin() {
                if (confirm('âš ï¸ ê²½ê³ !\n\nì •ë§ë¡œ ì´ ê´€ë¦¬ì ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì‚­ì œëœ ê´€ë¦¬ì ê³„ì •ì€ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nì‹ ì¤‘íˆ ê²°ì •í•´ ì£¼ì„¸ìš”.')) {
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = '/api/admin/admins/' + [[${admin.userId}]] + '/delete';
                    document.body.appendChild(form);
                    form.submit();
                }
            }
        </script>
    </th:block>
</body>
</html>