<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/admin-layout}"
      lang="ko">
<head>
    <title>ê³µì§€ ìƒì„¸ì •ë³´</title>
</head>
<body>
<div layout:fragment="content-header" class="content-header">
    <h2 style="color: #333; font-size: 20px;">ê³µì§€ ìƒì„¸ì •ë³´</h2>
    <div class="header-actions">
        <a th:href="@{/api/admin/notices}" class="btn btn-secondary">ëª©ë¡ìœ¼ë¡œ</a>
    </div>
</div>

<div layout:fragment="content">
    <div th:if="${param.success}" class="alert alert-success">ê³µì§€ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
    <div th:if="${param.error}" class="alert alert-danger" th:text="${param.error}">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>
    <div th:if="${param.updated}" class="alert alert-success">ê³µì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.</div>

    <div class="mode-selector">
        <button id="viewMode" class="mode-btn active" onclick="toggleMode('view')">ğŸ‘ï¸ ë³´ê¸° ëª¨ë“œ</button>
        <button id="editMode" class="mode-btn" onclick="toggleMode('edit')">âœï¸ ìˆ˜ì • ëª¨ë“œ</button>
    </div>

    <!-- ì½ê¸° ì „ìš© -->
    <div class="detail-card" id="viewSection">
        <h3>ğŸ“‹ ê³µì§€ ì •ë³´</h3>
        <div class="detail-grid">
            <div class="detail-label">ì œëª©</div>
            <div class="detail-value" th:text="${notice.title}">ê³µì§€ ì œëª©</div>

            <div class="detail-label">ì‘ì„±ì</div>
            <div class="detail-value" th:text="${notice.writerName != null ? notice.writerName : 'ì•Œ ìˆ˜ ì—†ìŒ'}">ì‘ì„±ì</div>

            <div class="detail-label">ì‘ì„±ì¼</div>
            <div class="detail-value" th:text="${#temporals.format(notice.createTime, 'yyyy-MM-dd HH:mm')}">2024-01-01 12:00</div>

            <div class="detail-label" th:if="${notice.updateTime != null}">ìˆ˜ì •ì¼</div>
            <div class="detail-value" th:if="${notice.updateTime != null}" th:text="${#temporals.format(notice.updateTime, 'yyyy-MM-dd HH:mm')}">2024-01-01 12:00</div>
        </div>

        <div class="content-section">
            <div class="detail-label">ë‚´ìš©</div>
            <div class="content-display" th:text="${notice.content}">ê³µì§€ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
        </div>
    </div>

    <!-- ìˆ˜ì • í¼ -->
    <div class="detail-card" id="editSection" style="display: none;">
        <h3>âœï¸ ê³µì§€ ì •ë³´ ìˆ˜ì •</h3>
        <form th:action="@{/api/admin/notices/{id}/update(id=${notice.noticeId})}" method="post">
            <div class="form-group">
                <label for="title">ì œëª© *</label>
                <input type="text" id="title" name="title" th:value="${notice.title}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="content">ë‚´ìš© *</label>
                <textarea id="content" name="content" th:text="${notice.content}" class="form-control content-textarea" required rows="10"></textarea>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">ğŸ’¾ ìˆ˜ì • ì €ì¥</button>
                <button type="button" class="btn btn-danger" onclick="deleteNotice()">ğŸ—‘ï¸ ì‚­ì œ</button>
                <button type="button" class="btn btn-secondary" onclick="toggleMode('view')">âŒ ì·¨ì†Œ</button>
            </div>
        </form>
    </div>

    <div class="readonly-message" id="readonlyMessage">
        <strong>ì½ê¸° ì „ìš© ëª¨ë“œ</strong><br>í˜„ì¬ ê³µì§€ ì •ë³´ ì¡°íšŒë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
    </div>
</div>

<th:block layout:fragment="extra-css">
    <style>
        .mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        .mode-btn {
            padding: 8px 16px;
            border: 1px solid #dee2e6;
            background-color: #ffffff;
            color: #6c757d;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .mode-btn:hover {
            background-color: #e9ecef;
        }

        .mode-btn.active {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }

        .detail-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .detail-card h3 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 18px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 12px 20px;
            margin-bottom: 20px;
        }

        .detail-label {
            font-weight: 600;
            background-color: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            color: #495057;
        }

        .detail-value {
            padding: 8px 12px;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            background-color: white;
        }

        .content-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .content-display {
            background-color: #f8f9fa;
            padding: 16px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            white-space: pre-wrap;
            line-height: 1.6;
            margin-top: 8px;
            min-height: 120px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #495057;
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-control:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }

        .content-textarea {
            resize: vertical;
            font-family: inherit;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .btn {
            padding: 10px 16px;
            border: 1px solid transparent;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }

        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .btn-danger:hover {
            background-color: #c82333;
            border-color: #bd2130;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
            border-color: #6c757d;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
            border-color: #545b62;
        }

        .readonly-message {
            background-color: #e7f3ff;
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid #bee5eb;
        }

        .alert {
            padding: 12px 16px;
            margin-bottom: 20px;
            border-radius: 6px;
            border: 1px solid transparent;
        }

        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }

        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .detail-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .form-actions {
                flex-direction: column;
            }

            .mode-selector {
                flex-direction: column;
            }

            .content-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</th:block>

<th:block layout:fragment="extra-scripts">
    <script>
        function toggleMode(mode) {
            const viewBtn = document.getElementById('viewMode');
            const editBtn = document.getElementById('editMode');
            const viewSection = document.getElementById('viewSection');
            const editSection = document.getElementById('editSection');
            const readonlyMessage = document.getElementById('readonlyMessage');

            if (mode === 'view') {
                viewBtn.classList.add('active');
                editBtn.classList.remove('active');
                viewSection.style.display = 'block';
                editSection.style.display = 'none';
                readonlyMessage.style.display = 'block';
            } else {
                editBtn.classList.add('active');
                viewBtn.classList.remove('active');
                viewSection.style.display = 'none';
                editSection.style.display = 'block';
                readonlyMessage.style.display = 'none';
            }
        }

        function deleteNotice() {
            if (confirm('ì •ë§ë¡œ ì´ ê³µì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = '/api/admin/notices/' + [[${notice.noticeId}]] + '/delete';
                document.body.appendChild(form);
                form.submit();
            }
        }
    </script>
</th:block>
</body>
</html>