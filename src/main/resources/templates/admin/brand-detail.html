<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
      layout:decorate="~{layout/admin-layout}"
      lang="ko">
<head>
    <title>ë¸Œëœë“œ ìƒì„¸ì •ë³´</title>
</head>
<body>
    <div layout:fragment="content-header" class="content-header">
        <h2 style="color: #333; font-size: 20px;">ë¸Œëœë“œ ìƒì„¸ì •ë³´</h2>
        <div class="header-actions">
            <a th:href="@{/api/admin/brands}" class="btn btn-secondary">ëª©ë¡ìœ¼ë¡œ</a>
        </div>
    </div>

    <div layout:fragment="content">
        <div th:if="${param.success}" class="alert alert-success">ë¸Œëœë“œ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
        <div th:if="${param.error}" class="alert alert-danger" th:text="${param.error}">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>

        <div class="mode-selector">
            <button id="viewMode" class="mode-btn active" onclick="toggleMode('view')">ğŸ‘ï¸ ë³´ê¸° ëª¨ë“œ</button>
            <button id="editMode" class="mode-btn" onclick="toggleMode('edit')">âœï¸ ìˆ˜ì • ëª¨ë“œ</button>
        </div>

        <!-- ì½ê¸° ì „ìš© -->
        <div class="detail-card" id="viewSection">
            <h3>ğŸ·ï¸ ë¸Œëœë“œ ì •ë³´</h3>
            <div class="brand-info">
                <div th:if="${brand.logoUrl}" class="brand-logo-large">
                    <img th:src="${brand.logoUrl}" alt="ë¸Œëœë“œ ë¡œê³ " style="width: 120px; height: 120px; object-fit: cover; border-radius: 8px;">
                </div>
                <div class="brand-details">
                    <div class="detail-grid">
                        <div class="detail-label">ë¸Œëœë“œëª…</div><div class="detail-value" th:text="${brand.brandName}">ë¸Œëœë“œëª…</div>
                        <div class="detail-label">ìƒí’ˆ ìˆ˜</div><div class="detail-value" th:text="${brand.productCount} + 'ê°œ'">0ê°œ</div>
                        <div class="detail-label">ì„¤ëª…</div><div class="detail-value" th:text="${brand.brandDescription ?: 'ì„¤ëª… ì—†ìŒ'}">ì„¤ëª…</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ìˆ˜ì • í¼ -->
        <div class="detail-card" id="editSection" style="display: none;">
            <h3>âœï¸ ë¸Œëœë“œ ì •ë³´ ìˆ˜ì •</h3>
            <form th:action="@{/api/admin/brands/{brandId}/update(brandId=${brand.brandId})}" method="post">
                <div class="form-group">
                    <label for="brandName">ë¸Œëœë“œëª… *</label>
                    <input type="text" id="brandName" name="brandName" th:value="${brand.brandName}" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="logoUrl">ë¡œê³  URL</label>
                    <input type="url" id="logoUrl" name="logoUrl" th:value="${brand.logoUrl}" class="form-control">
                </div>
                <div class="form-group">
                    <label for="brandDescription">ë¸Œëœë“œ ì„¤ëª…</label>
                    <textarea id="brandDescription" name="brandDescription" th:text="${brand.brandDescription}" 
                              class="form-control" rows="4"></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">ğŸ’¾ ìˆ˜ì • ì €ì¥</button>
                    <button type="button" class="btn btn-danger" onclick="deleteBrand()">ğŸ—‘ï¸ ì‚­ì œ</button>
                    <button type="button" class="btn btn-secondary" onclick="toggleMode('view')">âŒ ì·¨ì†Œ</button>
                </div>
            </form>
        </div>

        <div class="readonly-message" id="readonlyMessage">
            <strong>ì½ê¸° ì „ìš© ëª¨ë“œ</strong><br>í˜„ì¬ ë¸Œëœë“œ ì •ë³´ ì¡°íšŒë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
        </div>
    </div>

    <th:block layout:fragment="extra-css">
        <style>
            .mode-selector { display: flex; gap: 10px; margin-bottom: 20px; padding: 10px; background-color: #f8f9fa; border-radius: 8px; }
            .mode-btn { padding: 8px 16px; border: 1px solid #dee2e6; background-color: #ffffff; color: #6c757d; border-radius: 6px; cursor: pointer; }
            .mode-btn.active { background-color: #007bff; color: white; }
            .brand-info { display: flex; gap: 20px; align-items: flex-start; }
            .detail-grid { display: grid; grid-template-columns: 120px 1fr; gap: 12px 20px; }
            .detail-label { font-weight: 600; background-color: #f8f9fa; padding: 8px 12px; border-radius: 6px; }
            .detail-value { padding: 8px 12px; border: 1px solid #e9ecef; border-radius: 6px; }
            .form-group { margin-bottom: 15px; }
            .form-control { width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 6px; }
            .form-actions { display: flex; gap: 10px; margin-top: 20px; }
            .readonly-message { background-color: #e7f3ff; padding: 16px; border-radius: 8px; margin-top: 20px; }
            .alert { padding: 12px; margin-bottom: 20px; border-radius: 4px; }
            .alert-success { color: #155724; background-color: #d4edda; }
            .alert-danger { color: #721c24; background-color: #f8d7da; }
        </style>
    </th:block>

    <th:block layout:fragment="extra-scripts">
        <script>
            function toggleMode(mode) {
                const viewBtn = document.getElementById('viewMode');
                const editBtn = document.getElementById('editMode');
                const viewSection = document.getElementById('viewSection');
                const editSection = document.getElementById('editSection');
                const readonlyMessage = document.getElementById('readonlyMessage');
                
                if (mode === 'view') {
                    viewBtn.classList.add('active'); editBtn.classList.remove('active');
                    viewSection.style.display = 'block'; editSection.style.display = 'none'; readonlyMessage.style.display = 'block';
                } else {
                    editBtn.classList.add('active'); viewBtn.classList.remove('active');
                    viewSection.style.display = 'none'; editSection.style.display = 'block'; readonlyMessage.style.display = 'none';
                }
            }
            function deleteBrand() {
                if (confirm('ì •ë§ë¡œ ì´ ë¸Œëœë“œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = '/api/admin/brands/' + [[${brand.brandId}]] + '/delete';
                    document.body.appendChild(form);
                    form.submit();
                }
            }
        </script>
    </th:block>
</body>
</html>